<!DOCTYPE html>
<html>
    <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-29519043-1"></script>
        <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());
         gtag('config', 'UA-29519043-1');
        </script>
        
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta property="og:title" content="risou's Lithograph" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://blog.risouf.net" />
        <meta property="og:image" content="https://blog.risouf.net/static/img/sunglass.jpeg" />
        <meta property="og:site_name" content="risou's Lithograph" />
        <meta property="og:description" content="risou's mini blog - writing about software engineering, thinking, private events" /><meta property="fb:app_id" content="2945406965474658" /><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@risou" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.min.css">
        <link rel="stylesheet" href="/static/main.css">
        <title>risou's Lithograph</title>
    </head>
    <body>
        <section class="hero is-medium is-bold is-dark">
            <div class="hero-body">
                <div class="container has-text-centered">
                    <h1 class="title is-1">risou's Lithograph</h1>
                </div>
            </div>
        </section>
        <section class="section">
            <div class="container">
                <nav class="level is-mobile">
                    <div class="level-left"></div>
                    <div class="level-right">
                        <p class="level-item">top</p>
                        <p class="level-item"><a href="/list.html">list</a></p>
                    </div>
                </nav>
                <article class="articles">
                    
                    <div class="article">
                        <h1 class="title is-2"><a href="/entry/2021-09-07-switch-github-actions.html">ブログの CI build を Travis CI から GitHub Actions に移行した</a></h1>
                        <div class="subtitle published">2021-09-07</div>
                        <div class="content">
                            <p>以前このブログに書いたけど、このブログは自作の静的サイトジェネレータ &ldquo;Lithograph&rdquo; を使っている。<br/>
Lithograph は GitHub Pages に対応しており、 <code>.travis.yml</code> を設定することで Travis CI 上で markdown から HTML を生成していた。</p>

<p>今回、この仕組みを Travis CI から GitHub Actions に移行した。<br/>
といっても移行対応のほとんどは8ヶ月ほど前に進めており、今回は残作業を完了したということになる。</p>

<p>Lithograph は Raku で書かれたアプリケーションであり、 Travis CI を採用していたのもこれに依るものが大きかった。当時、 Travis CI は Perl 6 （現在の Raku ）に対応していたのだ。<br/>
しかし、そもそも GitHub Pages を想定したアプリケーションだったこともあり、記事をビルドする仕組みも GitHub Actions に対応する方がコンパクトにまとまると考えた。</p>

<p>Travis CI から GitHub Actions への移行は難しくなく、 Raku のビルド環境を用意して Lithograph が提供するコマンドを実行するシェルファイルを実行すれば良かった。<br/>
Slack への通知も公開されている Action があり、それを使うだけだったのであまり時間をかけずに済んだ。</p>

<p>そして最後に、もうひとつのチャレンジとして今現在、この記事を &ldquo;github.dev&rdquo; で書いている。<br/>
ここで書いて、 Github Actions でビルドされ、ブログが更新されれば、 Git の実行環境がないマシンからでもブラウザひとつで記事を書くことができる。<br/>
ここまでできれば、静的サイトジェネレータとして僕が求めていた最低限の機能は揃ったと言えそうだ。<br/>
必要な機能のほとんどを GitHub に依存していることだけは好ましくないが、 GitHub が失われたとしてもエディタと Git とシェルスクリプトの実行環境があれば Lithograph は利用可能なので、ひとまずはこれで良いと思っている。<br/>
今後も時間を見つけて、少しずつ改善していければと思う。</p>
                        </div>
                    </div>
                
                    <div class="article">
                        <h1 class="title is-2"><a href="/entry/2021-08-26-isucon11-qualifying.html">ISUCON 11 予選で何もできずに敗退した話</a></h1>
                        <div class="subtitle published">2021-08-26</div>
                        <div class="content">
                            <p>書くのも恥ずかしい話だけど、まあちゃんと記録しておこうと思う。</p>

<p>昨年までと同様に会社の同僚たちと参加した。<br/>
今回は申し込みが先着順で結構タイトだった中、申込みを成功させてくれた同僚に感謝。<br/>
とはいえ、各々仕事やその他いろいろあり、事前準備は個別に少々といった感じで望むことになった。</p>

<p>同じメンバーで3回目くらいだったこともあり、しっかりと準備をするでもなく慣れた感じで当日を迎えた（これ自体が誤りであり、今まで予選を突破できていないのだから、今まで通り当日を迎えてはならない）。</p>

<p>今回もオンライン開催ということで、開始1時間くらい前から徐々にボイスチャットに合流し、手元の環境を確認。<br/>
今回は無事予定時刻に開始できたこともあり、いつものように環境を整えたり問題文を読んだりという手順で着手した。</p>

<p><a href="https://isucon.net/archives/56021246.html">ISUCON11 オンライン予選 全てのチームのスコア（参考値）</a> によると最終スコアは 12,373 点ということで今までで一番高い数値ではあるものの、上位のスコアもインフレを起こしており、この数値はスコアとしては非常に低かった（順位もおそらくよくて真ん中あたり、といったところだろうか）。</p>

<p>反省点はいっぱいある。後で自分が読みやすいように文章にするのではなくリスト形式でまとめておく。</p>

<ul>
<li>事前準備が全体的に不足していた</li>
<li>与えられるコードやマニュアル等、ひとつひとつどんなものがあるかをチームで最初に確認しておくべきだった</li>
<li>業務で使っていないこともあり慣れていない MySQL に対して、しっかり計測せずにインデキシングができていると思ってしまった</li>
<li>手元での開発にこだわり環境構築に時間をかけてしまった

<ul>
<li>3台提供されていたので序盤は1台借りてそこで開発をしても良かった</li>
</ul>
</li>
<li>おそらく問題の最も面白いであろうところに入るまでに時間をかけすぎてしまって、楽しみ尽くすことができなかった</li>
</ul>


<p>おそらくもっと前に進められれば異なる課題が見つかると思う。それを含めてクリアできたとして予選を突破できるかどうかはわからない。<br/>
しかし、こういう機会でないと経験できないことが多いとは毎回思っているので、次回も無事に開催されてほしいと思っているし、可能ならば次回も参加したい。</p>
                        </div>
                    </div>
                
                    <div class="article">
                        <h1 class="title is-2"><a href="/entry/2021-06-30-retrospective-of-last-2-years.html">この2年間を振り返る</a></h1>
                        <div class="subtitle published">2021-06-30</div>
                        <div class="content">
                            <p>前回の記事に引き続き振り返りの記事だが、特にこのタイミングで転職を考えていたりするわけではない。</p>

<p>ちょうど2021年も半分が終わろうという時期だけど、これも偶然で、長く関わっていた仕事がしばらく前にひとつの区切りを迎えたので、今回はこれを振り返ろうというものだ。<br/>
この2年はほとんど全てこのプロジェクトに関わる仕事をしたと言っても過言ではない、と言いたいところだが、実際には長期的に必要な他の仕事も並行して進めていた時期もあった。<br/>
そして先日、このプロジェクトが一つのゴールを迎えたので、この記事を書く運びとなった。</p>

<hr />

<p>事の始まりは2019年の8月だったと記憶している。<br/>
1週間程度のまとまった休みをとり、久方ぶりに実家に帰省した。<br/>
当時はまだ新しいウィルスが世界中で猛威を振るうとは露ほども思っていなかったけれど、実家への帰省は旅行と同様、できるときにやっておくべきだと今では思う。<br/>
それはさておき、実家から戻り仕事に復帰してすぐ、上司から「新しいプロジェクトがあり、そろそろ本格的に動き出すから入って」という話をもらった。</p>

<p>このときはまだ、プロジェクトを一から考え推し進める人だけが注力している状況で、経営層に近い人たちが要望や意見を述べたり、幾許かの提案をしている他はその人がすべてを考えているというような状況だった。</p>

<p>僕と同時期に関わり始めたメンバーも何人かおり、エンジニアだと iOS アプリの開発を担当してくれた同僚は8月から入っていた。</p>

<p>このプロジェクトは社内でもかなり大きな意味を持つもの、ということは経営層からもアピールがあったものの、実際にすぐ開発に入れるという状況でもなく、最初の3ヶ月くらいは関連するプロダクトをリサーチしたり、残っていた仕事を片付けながら、開発計画を練っていった。<br/>
（僕は直接は関わらなかったが、このタイミングでアプリエンジニアを1名採用した）</p>

<p>10月から11月にかけて、社内のエンジニアの誰にこのプロジェクトに関わってもらうかの検討も進めており、彼らの担当していた仕事が落ち着いたタイミングで順次プロジェクトに入ってもらった。<br/>
年明け2020年の1月には計画していた最後のエンジニアが参画してくれ、このプロジェクトが1つのゴールを迎える少し前までの間、1年以上同じチームで開発を進めることとなった。</p>

<p>ここでプロジェクトにおける僕の役割について言及しておくと、アプリの開発チームとサーバサイドの開発チームそれぞれに対してエンジニアリングマネージャとして、開発計画の策定や進捗の担保、外部のチームとの連携などを中心的に行った。<br/>
この仕事で僕と密接に関わったのはアプリ開発をやりきってくれた2名のアプリエンジニアと、既存の Web アプリケーションをこのプロジェクトに対応させるためのあれやこれやをやりきってくれた4名のサーバサイドエンジニア、そしてプロジェクトのリーダーだったと思う。<br/>
また、大事なこととして、このプロジェクトで作られたアプリおよび関連するサーバサイドのコードに、僕が書いたコードは1行も含まれていない。<br/>
求められた役割や、タスクの優先度、そして個人的な挑戦として、僕自身はエンジニアとしてカウントせずにプロジェクトは進められた。</p>

<p>アプリの開発については、関わっていた2名のエンジニアが非常に優秀だったこと、片手間でエンジニアとして入るには直近2年以上アプリ開発に関わっていなかった自分では力不足だったこともあり、マネージャとしての仕事に終始した。<br/>
ここについては面白いエピソードを書けたりはしないので言及しないでおこうと思う。</p>

<p>サーバサイドについては、新規に一から実装したわけではなく、既存コードについては僕自身も知見があったこともあり、こちらについては少し言及しておきたいと思う。</p>

<p>サーバサイドで既存のものを活用する案というのは僕が関わり始める前から出ていたものだ。<br/>
主な理由としては似たものをもうひとつ作るコストが大きいということ、一から作るのに十分なエンジニアを確保できる見込みがなかったことがあげられる。<br/>
とはいえ、既存のプロダクトに新しく大きな変更を入れ込むのは非常に難しかった。<br/>
既存のプロダクトも当時既に7年選手であり、現状のサービスイメージに対して最適な実装になっていない部分は少なからずあった。そこに新しいものを入れようというのだから当然ではある。</p>

<p>ざっとやったことを列挙すると以下のような感じになる。<br/>
（大事なことなので再度書くが、僕はこれらの実装部分については関わっていない）</p>

<ul>
<li>技術選定および新しく導入する技術についての調査・社内への情報展開</li>
<li>サービスで2番目に大きいデータのデータ構造を大きく変更</li>
<li>上記データに紐づくデータに様々な足かせとなるデータがあったので構造を刷新</li>
<li>技術的な側面の強い細かい仕様の検討・決定</li>
<li>既存プロダクトには存在しない新たなデータの構造設計・実装</li>
<li>いくつかの複雑な実装についてそれぞれに注力する期間を設けて、個別に対応</li>
</ul>


<p>実装に関わっていない人間がこれらにどう貢献したのか、というとこれは難しいところだと思っている。<br/>
自分の視点では、自分がいなくてもちゃんとゴールに到達できたように見えるし、一方で現実にはそうではない何かがある可能性が高い（でなければ、僕はコードを書いていた方がよほど貢献できたことになる）。</p>

<p>アプリもサーバサイドも、実装自体はかなり順調に進んだように思う。<br/>
計画に対して、完了時期が大きく後ろにズレたりといったことは全くなかった。<br/>
ずっと同じメンバーで進めていたからか、見積もり精度もどんどん上がっていって、後半は開発進捗が予測を下回ることはほぼなかった。<br/>
また、初期の概算見積もりに対しても、最終的にはほとんどオンスケジュールというか、予測した期間で予定通りの進捗が出せるという非常に安定したスピードでの開発が行えた。</p>

<p>このあたりについてマネージャ目線で何が良かったのか、どうすれば再現できるか、については思うところはあるものの、環境要因のものも少なくないし、自分の中でちゃんと整理しきれていない気がしているので、ここでは言及しないでおこうと思う。</p>

<p>最後に、これから何をするかを少しだけ書いておこうと思う。</p>

<p>Web サービスなどの開発に関わっていると「リリースは終わりではなく始まり」といった言葉をよく聞くが、今回のプロジェクトもここから始まるといっても過言ではない。<br/>
が、僕はこのプロジェクトからは離れることになる。<br/>
理由は当然、他にやるべきことがあるからだが、そのうちの一つはこのプロジェクトが積み残した課題の一つであり、そういう意味では間接的に関わっていくことにはなる。<br/>
とはいえ、ここからというタイミングで離れざるを得ないのは非常に残念であり、その点については思うところはある。</p>

<p>これからやることになる仕事は、サービスやプロダクトというよりはシステム的な課題の解決を目的としたものが多く、そういう意味ではより得意な領域に移ると言えるかもしれない。<br/>
また、個人的な挑戦としてここ2年ほど業務でコードを書いていなかったわけだが、自分としては一定の目的は達成できたと考えているので、コードを書くエンジニアに復帰するつもりでいる（エンジニアリングマネージャをやめるわけではない）。<br/>
今一番の心配は2年のブランクを乗り越えてエンジニアとして前線でやっていける腕が残っているか、だ。</p>
                        </div>
                    </div>
                
                    <div class="article">
                        <h1 class="title is-2"><a href="/entry/2021-02-02-looking-back-my-recent-work.html">直近の仕事を振り返る</a></h1>
                        <div class="subtitle published">2021-02-02</div>
                        <div class="content">
                            <p>先日、現在関わっている会社が1つの区切りの日のようなものを迎えたらしい。<br/>
その会社の事業はまだまだ一区切りにも程遠いように見える（これは悪いことではない）が、自分にとっても関わりはじめてそれなりに時が経つのだなあ、という思いもあり、この会社に関わる前と後についてちょっと整理しておこうと思った。</p>

<p>以下で記すのは、現在関わっている会社およびその前に関わっていた会社に関することのみである。</p>

<hr />

<p>前職の会社には、社員からの紹介で入った。<br/>
紹介してくれた人は同業者として以前から尊敬している人で、会社自体への魅力はもちろん、その人と一緒に働ける可能性にも魅力を感じての転職だった。</p>

<p>結局、紹介してくれた人とは直接一緒に働くことはなかったけれど、在籍期間中に自分が関わっていた仕事に（僕が入社するより）以前に関わっていたこともあり、その人の仕事ぶりを後から拝見させていただく機会は少なくなく、学ぶところも大いにあった。<br/>
また、関わっている仕事は違えど同じ会社ではあったので、時に越境してこちらの仕事に関わってくれることもあったし、社外のイベントに一緒に参加させていただくこともあった。<br/>
そういう意味では入社の目的の1つは広義には果たせていたと思う。</p>

<p>前職の会社は自分にとって非常に働きやすい環境で、入社してすぐの頃は「試用期間で切られないといいな」という思いがあったし、試用期間をクリアした後は「この会社には長く在籍するだろうな」と思っていた。<br/>
働く環境という意味では（現職の会社も含めて）今まで体験したなかで最も良く、そこに対する未練のようなものは今でもある。</p>

<p>しかし、人生には時々、思ってもいない選択の機会が与えられることがある。</p>

<p>前職の会社で満足感高く働いていたある時、その思ってもいない選択が提示された。<br/>
それが現職の会社での仕事である。</p>

<p>僕にとってはどちらも非常に魅力的な選択で、しかし最終的にはどちらかを選ばなければならなかった。<br/>
僕は（優先順位の問題で）仕事に関してはあまりリスクをとろうという気持ちがない。<br/>
現職での仕事は内容はともかく環境という面については僕にとってリスクのある選択肢だった。<br/>
とはいえ、人生において刺激というものはある程度必要……というか自分が新しいことに挑戦したい気持ちを持っていたのも事実。<br/>
前職での仕事にもう少しやりきった感を持っていれば、ためらいなく現職での仕事を選んだと思う。</p>

<p>結局のところ、僕は現職での仕事を選んだ。<br/>
悩む時間はあまり多くは与えられていなかったが、その間にしっかりと比較検討し、自分なりに大丈夫（生活に支障をきたさない）という計算をしてから決定した。<br/>
前職の会社と現職の会社では色々と異なることも多く、働く環境としては失ったものも少なからずある。<br/>
それでも自身の選択に対しては一切の後悔はないし、一方で選択した際の計算通りに進んでいない事柄もある。<br/>
どちらかが正解だったわけでもなく、自分にとっては自分の選択こそが正解だった。</p>

<p>そんなわけで、「自分はこの会社に長くいるだろうな」と思った会社に在籍した期間と同じ期間を今の会社で過ごしている。<br/>
もしかしたらそのうちまた似たような選択の機会が急に来るかもしれないし、その時はその時で自分にとっての正解を選ぶだろう。<br/>
幸いにも、今はまだ次の選択を迫られていないし、現職の会社でやりたいことも残っている。<br/>
次のことを思い悩むのはまだ先のことのようだ。</p>
                        </div>
                    </div>
                
                    <div class="article">
                        <h1 class="title is-2"><a href="/entry/2020-10-16-think-about-among-us-and-werewolf-game.html">Among Us プレイ雑感と人狼ゲームの間口の狭さ</a></h1>
                        <div class="subtitle published">2020-10-16</div>
                        <div class="content">
                            <p>もしかして半年ぶりの更新だろうか。<br/>
この半年のことは別の記事で軽く触れられればと思う。</p>

<p>最近、一部界隈で急に賑わい出したゲームに Among Us がある。<br/>
観測する限りでは Steam の他に iOS/Android アプリも提供されている。<br/>
（そして素晴らしいことにクロスプレイに対応している）</p>

<p>このゲームはどうやら2018年頃にリリースされたようだが、最近になって急に知名度が上がった印象だ。</p>

<h2>Among Us とはどういうゲームか</h2>

<p>Among Us がどういうゲームかというと、簡単にいえば <strong>人狼風ゲーム</strong> だ。<br/>
特定の環境（宇宙船やその他いくつかのマップがある）から脱出するために、乗組員たちは協力してそれぞれにアサインされたタスクをこなしていく。<br/>
全てのタスクが完了すれば脱出できる。これがクリアだ。<br/>
ただし、乗組員の中に詐欺師が何人か紛れており、彼らは様々な手で乗組員たちを妨害しながら、隙を見て乗組員たちを殺していく。</p>

<p>人狼ゲームと同様にそれぞれのプレイヤーは役割によって勝利条件が異なる。<br/>
乗組員はタスクを完了させるか、詐欺師を全員追放することで勝利できる。<br/>
一方詐欺師は、生存する乗組員の人数を生存する詐欺師の数と同数まで減らせば勝ちとなる。</p>

<p>このゲームが人狼ゲームと大きく異なるのが、 <strong>ターン制ではない</strong> 仕組みだ。<br/>
人狼ゲームは基本的に1日を昼と夜にわけて、昼の終わりに一人を吊り、夜に最大一人が食べられる。<br/>
Among Us では詐欺師は任意のタイミングで乗組員を殺害できる。ただし、連続した殺害は不可能で、一度殺害を行えばしばらく（ホストによって設定された秒数の）クールタイムが発生する。<br/>
当然、乗組員による追放もターン制ではないが、こちらは任意のタイミングでできるわけではない。<br/>
追放を行うための投票は、「乗組員の死体を発見した者がレポートしたとき」か「一人一回のみ使用可能な緊急招集ボタンが押されたとき」だけだ。<br/>
双方が持つこれらの制限によって、ターン制ではない人狼ゲームがバランス良く機能していると言える。</p>

<h2>実際にプレイした感想</h2>

<p>Among Us は人狼系ゲームとしてよくできていると思う。<br/>
このゲームにはボイスチャットの仕組みはなく、コミュニケーションの手段としてはテキストチャットの機能のみ提供されている。<br/>
実際にプレイする際には別途 Discord などでボイスチャットの環境を用意した方がテンポもよく盛り上がるだろう。</p>

<p>人狼系ゲームとしてよくできている、というのは言い換えれば人狼系ゲームの難点も抱えているということだ。<br/>
つまり、 <strong>誰かを疑う、誰かに疑いを向けさせるような議論を行うことを苦手とする人</strong> にはこのゲームは楽しめない可能性が高い。</p>

<p>人狼ゲームは30年以上の歴史があるゲームであり、 Web の普及とともに知名度・プレイヤーを増やしてきた。オンラインでもオフラインでも楽しめるゲームだが、上記のようにプレイヤーにある程度のプレッシャーを強いるゲームでもあるため、楽しめる人と楽しめない人が明確にわかれやすい。</p>

<p>また、プレイヤーメタが発生しやすいという難点もある。<br/>
各プレイヤーの役割がいずれであったとしても、そのプレイヤー自身の普段の言動やイメージが他プレイヤーによる役割の推測に与える影響を無視できない。<br/>
（この問題はインターネット人狼であればプレイヤーを匿名化することで回避できる）<br/>
つまり、「この人は人狼っぽい」だったり「この人は嘘をつくのがうまい」だったりのイメージがゲームの純粋性を下げてしまう。<br/>
例えば僕は、人狼系ゲームで最初に人狼サイドに殺されてしまうことが非常に多い。</p>

<p>それでも僕は人狼系ゲームの多くを楽しめている。<br/>
しかし人によってはこれらの難点によって人狼系ゲームを楽しむことが難しい。<br/>
それはつまり、この手のゲームを楽しむ仲間を見つけるのが簡単ではないということだ。</p>

<p>先日 Among Us を遊んだ際にはいつも遊んでいる仲間で集まってプレイしたが、全員が全員このゲームを楽しめているわけではなさそうだった。<br/>
それは僕にとっては非常に申し訳ないことであり、同時にこのゲームをカジュアルに遊ぶ仲間を他で探してこないといけないということでもある。<br/>
人狼系ゲームはその性質上、ある程度の多人数でのプレイが推奨されるため、一緒に遊べる仲間が多くないと頻繁に遊ぶことが難しいのだ。</p>

<p>つまり何が言いたいかというと、誰か一緒に遊びませんか、という話。<br/>
（もし一緒に遊んでもいいよ、という人がいれば Twitter で <a href="https://twitter.com/risou">@risou</a> に声をかけてね）</p>
                        </div>
                    </div>
                
                </article>
            </div>
        </section>
        <footer class="footer">
            <div class="content has-text-centered">
                Copyright &copy; 2019- risou All Rights Reserved.
            </div>
        </footer>
    </body>
</html>
